import{r as t,u as w,j as e,b as A,k as r}from"./index-B9wrcDWQ.js";import{a as D}from"./objectCompraion-f8g0dwj-.js";import{P as F}from"./PageHeader-BHYpsllP.js";import{P as I}from"./Container-Dk9VdPk9.js";import{T as L}from"./TabContainer-DqSLoziL.js";import{T as h,a as x,S as n,C as c}from"./ToggleSwitch-0XDEILB1.js";import{b as p}from"./bus.service-DtEzQnLH.js";import{u as P}from"./url.service-CC_ivgR1.js";import"./ButtonList-DgGakKsg.js";const J=()=>{const[b,j]=t.useState(!0),[o,v]=t.useState(null),g=w(),[s,m]=t.useState({busNumber:"",isAc:!1,isLowFloor:!1,passengerType:"Regular",specialService:!1,isNightService:!1,passengerCapacity:"",busType:"City",fuelType:"Diesel",ticketingSystem:"Manual",liveTrackingUrl:""}),u=P.getId(),[y,f]=t.useState([{id:"save-bus",label:"Save",icon:"fa-solid:save",disabled:!0},{id:"delete-bus",label:"Delete",icon:"material-symbols:delete-rounded"}]),C=async()=>{try{const a=await p.getBusById(u);m(a.bus),v(a.bus)}catch(a){console.error("Error fetching bus data:",a),r.error("Failed to load bus data.")}finally{j(!1)}};t.useEffect(()=>{C()},[]),t.useEffect(()=>{if(s&&o){const a=!D(s,o,["createdAt","updatedAt"]);f(d=>d.map(l=>l.id==="save-bus"?{...l,disabled:!a}:l))}},[s,o]);const i=a=>{const{name:d,value:l,type:T,checked:k}=a.target;m(E=>({...E,[d]:T==="checkbox"?k:l}))},S=async()=>{if(!s.busNumber||!s.passengerCapacity){r.error("Please fill in all required fields.");return}try{await p.updateBus(u,s),r.success("Bus details updated successfully!")}catch(a){console.error("Error updating bus:",a),r.error("Failed to update bus.")}},B=async()=>{try{await p.deleteBus(u),r.success("Bus has been deleted!"),g(-1)}catch(a){console.error("Error deleting bus:",a),r.error("Failed to delete bus.")}},N=async a=>{if(a==="save-bus")return await S(),!0;a=="delete-bus"&&await B()};return e.jsxs(I,{children:[e.jsx(A,{show:b}),e.jsx(F,{title:`Buses > ${s.busNumber}`,description:"Edit bus details",buttons:y,onButtonClick:N,goBack:!0}),e.jsx(L,{children:e.jsxs(h,{variant:"underline",children:[e.jsx(h.Item,{active:!0,title:"Basic Information",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Bus Number"}),e.jsx(x,{name:"busNumber",value:s.busNumber,onChange:i,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Passenger Type"}),e.jsxs(n,{name:"passengerType",value:s.passengerType,onChange:i,children:[e.jsx("option",{value:"Regular",children:"Regular"}),e.jsx("option",{value:"Senior Citizen",children:"Senior Citizen"}),e.jsx("option",{value:"Student",children:"Student"}),e.jsx("option",{value:"Differently-Abled",children:"Differently-Abled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Passenger Capacity"}),e.jsx(x,{type:"number",name:"passengerCapacity",value:s.passengerCapacity,onChange:i,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Bus Type"}),e.jsxs(n,{name:"busType",value:s.busType,onChange:i,children:[e.jsx("option",{value:"City",children:"City"}),e.jsx("option",{value:"Intercity",children:"Intercity"}),e.jsx("option",{value:"Suburban",children:"Suburban"}),e.jsx("option",{value:"Special",children:"Special"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Fuel Type"}),e.jsxs(n,{name:"fuelType",value:s.fuelType,onChange:i,children:[e.jsx("option",{value:"Diesel",children:"Diesel"}),e.jsx("option",{value:"CNG",children:"CNG"}),e.jsx("option",{value:"Electric",children:"Electric"}),e.jsx("option",{value:"Hybrid",children:"Hybrid"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Ticketing System"}),e.jsxs(n,{name:"ticketingSystem",value:s.ticketingSystem,onChange:i,children:[e.jsx("option",{value:"Manual",children:"Manual"}),e.jsx("option",{value:"Online",children:"Online"}),e.jsx("option",{value:"Both",children:"Both"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Live Tracking URL (Optional)"}),e.jsx(x,{name:"liveTrackingUrl",value:s.liveTrackingUrl,onChange:i})]})]})}),e.jsx(h.Item,{title:"Additional Features",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{name:"isAc",checked:s.isAc,onChange:i}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"AC Bus"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{name:"isLowFloor",checked:s.isLowFloor,onChange:i}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Low Floor Bus"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{name:"specialService",checked:s.specialService,onChange:i}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Special Service"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{name:"isNightService",checked:s.isNightService,onChange:i}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Night Service"})]})]})})]})})]})};export{J as EditBus};
