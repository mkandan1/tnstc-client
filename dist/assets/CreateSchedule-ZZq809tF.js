import{c as b,u as D,r as n,j as e,k as i}from"./index-B9wrcDWQ.js";import{P as R}from"./Container-Dk9VdPk9.js";import{P as N}from"./PageHeader-BHYpsllP.js";import{T as p,S as r,a as j,B as P}from"./ToggleSwitch-0XDEILB1.js";import{r as _}from"./route.service-CcB9DkO7.js";import{b as E}from"./bus.service-DtEzQnLH.js";import{s as h}from"./scheduledBus.service-ImcWo4LN.js";import{d as q}from"./driver.service-CPuDNPLc.js";import{T as w}from"./TabContainer-DqSLoziL.js";import"./ButtonList-DgGakKsg.js";const K=()=>{const{id:l}=b(),S=D(),[g,m]=n.useState(!1),[f,v]=n.useState([]),[C,T]=n.useState([]),[y,B]=n.useState([]),[s,x]=n.useState({bus:"",driver:"",route:"",scheduleTime:"",status:"Scheduled",comments:"",realTimeTracking:!0});n.useEffect(()=>{(async()=>{try{m(!0);const[c,o,d]=await Promise.all([E.getAllBuses(),q.getAllDrivers(),_.getAllRoutes()]);if(v(c.buses),T(o),B(d),l){const u=await h.getScheduledBusById(l);x(u)}}catch(c){console.error("Error loading data:",c),i.error("Failed to load data")}finally{m(!1)}})()},[l]);const t=a=>{const{name:c,value:o,type:d,checked:u}=a.target;x({...s,[c]:d==="checkbox"?u:o})},k=async()=>{try{l?(await h.updateScheduledBus(l,s),i.success("Schedule updated successfully")):(await h.createScheduledBus(s),i.success("Schedule created successfully")),S(-1)}catch{i.error("Failed to save schedule")}};return e.jsxs(R,{children:[e.jsx(N,{title:"Create Schedule",description:"Fill the details to create schedule",buttons:[],goBack:!0}),e.jsx(w,{children:e.jsx(p,{children:e.jsx(p.Item,{title:"Bus Schedule",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Bus"}),e.jsxs(r,{name:"bus",value:s==null?void 0:s.bus,onChange:t,required:!0,children:[e.jsx("option",{value:"",children:"Select Bus"}),f.map(a=>e.jsx("option",{value:a==null?void 0:a._id,children:a==null?void 0:a.busNumber},a==null?void 0:a._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Driver"}),e.jsxs(r,{name:"driver",value:s==null?void 0:s.driver,onChange:t,required:!0,children:[e.jsx("option",{value:"",children:"Select Driver"}),C.map(a=>e.jsx("option",{value:a==null?void 0:a._id,children:(a==null?void 0:a.firstName)+" "+(a==null?void 0:a.lastName)},a==null?void 0:a._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Route"}),e.jsxs(r,{name:"route",value:s==null?void 0:s.route,onChange:t,required:!0,children:[e.jsx("option",{value:"",children:"Select Route"}),y.map(a=>e.jsx("option",{value:a==null?void 0:a._id,children:a==null?void 0:a.routeName},a==null?void 0:a._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Schedule Time"}),e.jsx(j,{type:"datetime-local",name:"scheduleTime",value:s==null?void 0:s.scheduleTime,onChange:t,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Status"}),e.jsxs(r,{name:"status",value:s==null?void 0:s.status,onChange:t,children:[e.jsx("option",{value:"Scheduled",children:"Scheduled"}),e.jsx("option",{value:"On Route",children:"On Route"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Comments"}),e.jsx(j,{type:"text",name:"comments",value:s==null?void 0:s.comments,onChange:t,placeholder:"Optional"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:"realTimeTracking",checked:s==null?void 0:s.realTimeTracking,onChange:t}),e.jsx("label",{children:"Enable Real-Time Tracking"})]}),e.jsx(P,{onClick:k,disabled:g,children:l?"Update Schedule":"Create Schedule"})]})})})})]})};export{K as default};
